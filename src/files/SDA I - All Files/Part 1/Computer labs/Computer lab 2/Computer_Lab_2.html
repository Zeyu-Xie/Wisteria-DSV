<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>COMPUTER LAB 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Computer_Lab_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="Computer_Lab_2_files/libs/quarto-html/quarto.js"></script>
<script src="Computer_Lab_2_files/libs/quarto-html/popper.min.js"></script>
<script src="Computer_Lab_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Computer_Lab_2_files/libs/quarto-html/anchor.min.js"></script>
<link href="Computer_Lab_2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Computer_Lab_2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Computer_Lab_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Computer_Lab_2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Computer_Lab_2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#first-part" id="toc-first-part" class="nav-link active" data-scroll-target="#first-part"><span class="header-section-number">1</span> First Part</a>
  <ul class="collapse">
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">1.1</span> Data</a></li>
  <li><a href="#categorical-variables" id="toc-categorical-variables" class="nav-link" data-scroll-target="#categorical-variables"><span class="header-section-number">1.2</span> Categorical variables</a></li>
  <li><a href="#numerical-variables" id="toc-numerical-variables" class="nav-link" data-scroll-target="#numerical-variables"><span class="header-section-number">1.3</span> Numerical variables</a></li>
  <li><a href="#missing-values" id="toc-missing-values" class="nav-link" data-scroll-target="#missing-values"><span class="header-section-number">1.4</span> Missing values</a></li>
  </ul></li>
  <li><a href="#second-part" id="toc-second-part" class="nav-link" data-scroll-target="#second-part"><span class="header-section-number">2</span> Second Part</a>
  <ul class="collapse">
  <li><a href="#relationship-between-two-categorical-variables" id="toc-relationship-between-two-categorical-variables" class="nav-link" data-scroll-target="#relationship-between-two-categorical-variables"><span class="header-section-number">2.1</span> Relationship between two categorical variables</a></li>
  <li><a href="#relationship-between-one-numerical-variable-and-one-or-more-categorical-variables." id="toc-relationship-between-one-numerical-variable-and-one-or-more-categorical-variables." class="nav-link" data-scroll-target="#relationship-between-one-numerical-variable-and-one-or-more-categorical-variables."><span class="header-section-number">2.2</span> Relationship between one numerical variable and one (or more) categorical variable(s).</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">COMPUTER LAB 2</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Today’s lab is divided in two parts, covering mainly two topics:</p>
<ul>
<li><p>First Part: how to describe numerically and graphically both categorical and numerical variables.</p></li>
<li><p>Second Part: how to measure the relationship between two categorical variables, as well as the relationship between one numerical variable and one (or more) categorical variable(s).</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The relationship between two numerical variables will be covered in Lab 3!</p>
</div>
</div>
<p>Before we start, we need some preparations. We will be using the datasets <code>Titanic.xlsx</code>, <code>SmartPhones.RData</code> and <code>FevChildren.RData</code> that can be found in Athena, under the folder for the second computer lab. Download the files into a folder in your computer. Then change R’s working directory to that folder: click on the <code>Session</code> menu at the top of the screen, then <code>Set working directory</code>, then <code>Choose directory</code> and then navigate to the folder where you downloaded the datasets.</p>
<p>Let us install amd load the packages <code>mosaic</code>, <code>openxlsx</code>, <code>DescTools</code> and <code>e1071</code>. In the previous computer lab, we have learnt how to install a package in R. Recall that the installation is needed only once, whereas the packages have to be loaded (through the command <code>library()</code> every time we start Rstudio)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"mosaic"</span>) <span class="co">#this is needed just for the first time</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"openxlsx"</span>) <span class="co">#this is needed just for the first time</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"DescTools"</span>) <span class="co">#this is needed just for the first time</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"e1071"</span>) <span class="co">#this is needed just for the first time</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mosaic)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DescTools)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="first-part" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="first-part"><span class="header-section-number">1</span> First Part</h2>
<section id="data" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="data"><span class="header-section-number">1.1</span> Data</h3>
<p>Throughout the first part of this computer lab we will use the built-in dataset <code>iris</code>. This dataset contains measurements on three species of Iris flowers.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>R is plenty of built-in (pre-loaded) datasets! In order to load a built-in dataset, we can use the function <code>data()</code>, specifying the name of the dataset as argument. In this case, since the name of the dataset is <code>iris</code>, the following code will load our data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can get information about the dataset by typing <code>help(iris)</code>.</p>
<p>If you are curious, you can type the command <code>data()</code>, without any argument, and you will get the list of all built-in datasets!</p>
</div>
</div>
<p>It is a good habit, before starting any type of analysis, to have a look at the dataset to check which variables it includes. For this purpose, the function <code>head()</code> (which we already introduced in Lab 1) can be used. The function <code>head()</code> allows us to look at the first 6 rows of a dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>From the output, we can see that we have 5 variables in the dataset. In particular, this dataset consists of four numerical variables, namely <code>Sepal.Length</code>, <code>Sepal.Width</code>, <code>Petal.Length</code> and <code>Petal.Width</code>, and a categorical variable, <code>Species</code>.</p>
<p>We may also be interested in finding the number of observations present in the dataset. The function <code>dim()</code> takes a dataset as input and it returns a vector where the first value is the number of rows (observations) and the second value is the number of columns (variables). Alternatively, these two values can be obtained separately by using the functions <code>nrow()</code>and <code>ncol()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(iris)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(iris)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It is also important to look at how the variables in the dataset are stored. The function <code>str()</code> can then be used to get the structure of the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="categorical-variables" class="level3" data-number="1.2">
<h3 data-number="1.2" class="anchored" data-anchor-id="categorical-variables"><span class="header-section-number">1.2</span> Categorical variables</h3>
<p>Let us start with categorical variables. A <strong>categorical variable</strong> is a variable whose values are categories. It is important to remind the fact that a categorical variable can be measured either on the nominal scale or on the ordinal scale. An example of a categorical variable measured on the nominal scale is gender. There is no order between the categories of the variable gender. On the other hand, an example of a categorical variable measured on the ordinal scale is the grade. In fact, the grade A is better then the grade C. For the moment, we do not need to worry about this distinction.</p>
<p>Now, we are going to analyse the categorical variable <code>Species</code> from the <code>iris</code> dataset. Looking at the output of the <code>str()</code> function, we see that this variable is a factor (a categorical variable) with three “levels” (<code>setosa</code>, <code>virginica</code> and <code>versicolor</code>). In R the categories of a variable are called <em>levels</em>.</p>
<p>It is also possible to get the different categories of a categorical variable by using the function <code>levels()</code>. The function <code>levels()</code> takes a vector as input and it returns a vector with its levels as output.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>cat.iris <span class="ot">&lt;-</span> <span class="fu">levels</span>(iris<span class="sc">$</span>Species)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>cat.iris</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "setosa"     "versicolor" "virginica" </code></pre>
</div>
</div>
<p>Recall that the symbol $ tells to R to pick the variable <code>Species</code> from the dataset <code>iris</code>.</p>
<p>If we would like to get the number of categories, we can use the function <code>length()</code>. The function <code>length()</code> takes a vector as input and it returns the number of elements contained in it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(cat.iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>Before we continue analyzing our categorical variable, let us discuss on some characteristics of factors in R.</p>
<section id="categorical-variables-as-factors-in-r" class="level4" data-number="1.2.1">
<h4 data-number="1.2.1" class="anchored" data-anchor-id="categorical-variables-as-factors-in-r"><span class="header-section-number">1.2.1</span> Categorical variables as factors in R</h4>
<p>It is always a good habit to store a categorical variable as a <code>factor</code> variable, as suggested in Lab 1. As could be seen from the output of the function <code>str()</code>, the categorical variable <code>Species</code> is already stored as a <code>factor</code>variable.</p>
<p>When we load a dataset into R, it is common that a categorical variable is not stored as a <code>factor</code>. It can be stored as <code>character</code> (a vector containing strings) or even as a <code>numerical</code> variable. In principle, there is nothing wrong with that. However, it is “more correct” and convenient to define it as a categorical variable, that is, by using the function <code>factor()</code>. You have already seen this function in the first computer lab!</p>
<p>Let us make an example. Let us consider the following categorical variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>grades <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"F"</span>, <span class="st">"A"</span>, <span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We have defined the object <code>grades</code> as a vector that contains the grades of five students in an exam. Because of the way it was defined, this vector is stored as a <code>character</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(grades)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us convert the categorical variable <code>grades</code> to a <code>factor</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>grades_fact <span class="ot">&lt;-</span> <span class="fu">factor</span>(grades)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(grades_fact)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "factor"</code></pre>
</div>
</div>
<p>By default, the levels of the factor variable are the different values taken by the categorical variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(grades_fact)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "A" "F"</code></pre>
</div>
</div>
<p>Now let us introduce some of the advantages of working with factors:</p>
<ul>
<li>In some situations it is known that the variable has more levels than those that we have observed and we want to have that information into account. For instance, in the example with the grades, the students only got A or F but we know that the categorical variable can take also the values B, C, D, E and Fx and we would like R to have that information “in mind”. If we want to add more levels, we can use the argument <code>levels</code> as follows:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>my.levels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"Fx"</span>, <span class="st">"E"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>grades_fact <span class="ot">&lt;-</span> <span class="fu">factor</span>(grades, <span class="at">levels=</span>my.levels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>By default the different categories (levels) do not have an order, in other words, by default R is considering the variable as a nominal variable. If we want the order of the levels to have a meaning, i.e.&nbsp;if we want R to consider the variable as an ordinal variable, we have to define the levels in increasing order and use the argument <code>ordered</code> as follows:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>grades_fact <span class="ot">&lt;-</span> <span class="fu">factor</span>(grades, <span class="at">levels=</span>my.levels, <span class="at">ordered=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>It is common to use codes for the different categories of a variable, for instance, in some datasets we may find the variable <code>sex</code> taking the values 1 and 2, instead of <code>man</code> or <code>woman</code>. In those cases, it may be useful to let R know the true “meaning” of the different categories. As an example, the grades A to F are just codes whose meaning is as follows:
<ul>
<li>A: Excellent;</li>
<li>B: Very good;</li>
<li>C: Good;</li>
<li>D: Satisfactory;</li>
<li>E: Adequate;</li>
<li>Fx: Inadequate;</li>
<li>F: Totally inadequate.</li>
</ul></li>
</ul>
<p>In order to let R know the “true” meaning of the categories we can use the argument <code>labels</code> as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>my.labels <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Totally inadequate"</span>, <span class="st">"Inadequate"</span>,<span class="st">"Adequate"</span>,</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>              <span class="st">"Satisfactory"</span>,<span class="st">"Good"</span>,<span class="st">"Very good"</span>,<span class="st">"Excellent"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>grades_new <span class="ot">&lt;-</span> <span class="fu">factor</span>(grades, <span class="at">levels=</span>my.levels, <span class="at">labels=</span>my.labels, <span class="at">ordered=</span><span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After this brief description of the function <code>factor()</code>, we can continue analyzing the variable <code>Species</code>.</p>
</section>
<section id="frequency-distributions" class="level4" data-number="1.2.2">
<h4 data-number="1.2.2" class="anchored" data-anchor-id="frequency-distributions"><span class="header-section-number">1.2.2</span> Frequency distributions</h4>
<p>A categorical variable can be summarized by its frequency distribution. A frequency distribution counts the number of times each category is present in the variable.</p>
<p>In order to get a frequency distribution in R, we can use the function <code>tally()</code> from the package <code>mosaic</code> as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(<span class="sc">~</span> Species, <span class="at">data =</span> iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note most of the functions in the package <code>mosaic</code> start with the symbol <code>~</code>. This is called the Tilde Operator. You can see more information about this operator by typing <code>help("~")</code></p>
</div>
</div>
<p>We did not save the frequency distribution above. If we need it later in the analysis, it can be saved by assigning what we have obtained before to a variable (the name can be chosen as you like).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>freq_distr <span class="ot">&lt;-</span> <span class="fu">tally</span>(<span class="sc">~</span> Species, <span class="at">data =</span> iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>After that, the output can be shown by typing</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>freq_distr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sometimes we want the proportions, not the raw frequencies. Therefore, the relative frequency distribution is needed. A relative frequency distribution is obtained by dividing the frequencies by the number of observations. In R it can be obtained by using the argument <code>format = "proportion"</code> in the <code>tally()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(<span class="sc">~</span> Species, <span class="at">data =</span> iris, <span class="at">format =</span> <span class="st">"proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="**EXERCISE**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>EXERCISE</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li>Load the built-in dataset <code>mtcars</code>.</li>
<li>Get information about this dataset by typing <code>help(mtcars)</code>.</li>
<li>Present the frequency distribution and the relative frequency distribution of the variable <code>am</code>.</li>
</ol>
<p><strong>Note:</strong> Remember that, if a categorical variable is not stored as <code>factor</code>, you should convert it!</p>
</div>
</div>
</section>
<section id="graphical-description-for-categorical-variables" class="level4" data-number="1.2.3">
<h4 data-number="1.2.3" class="anchored" data-anchor-id="graphical-description-for-categorical-variables"><span class="header-section-number">1.2.3</span> Graphical description for categorical variables</h4>
<p>There are two types of graphs that are mainly used to describe a categorical variable: pie charts and bar charts. While bar charts can be used for both nominal and ordinal variables, pie charts are usually more suitable for nominal variables.</p>
<p>The functions <code>pie()</code>and <code>bargraph()</code> can be used to create a pie chart and a bar chart, respectively. As before, the variable that we are going to analyze is <code>Species</code>.</p>
<section id="pie-chart" class="level5" data-number="1.2.3.1">
<h5 data-number="1.2.3.1" class="anchored" data-anchor-id="pie-chart"><span class="header-section-number">1.2.3.1</span> Pie chart</h5>
<p>Let us start with the pie chart. As mentioned above, the function <code>pie()</code> is used to create a pie chart.</p>
<p>The function <code>pie()</code> takes a previously saved frequency distribution as input. This means that, first we need to create a frequency distribution, save it, and then we can create the pie chart. That is why before we suggested to save the frequency distribution!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>freq_distr <span class="ot">&lt;-</span> <span class="fu">tally</span>(<span class="sc">~</span> Species, <span class="at">data =</span> iris, <span class="at">format =</span> <span class="st">"proportion"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(freq_distr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By default, the names that appear in the pie chart are equal to names of the vector <code>freq_distr</code>. But we can change them by using the argument <code>labels</code> in the function <code>pie</code>. We just need to use a vector with the new names. It is important to say that, by doing so, we are not altering the names of the vector <code>freq_distr</code>, but just the labels in the pie chart are changed. Let us say that we want to have <code>Type 1. Setosa</code>, <code>Type 2. Versicolor</code> and <code>Type 3. Virginica</code> instead, then we can use</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>new_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Type 1. Setosa"</span>, <span class="st">"Type 2. Versicolor"</span>, <span class="st">"Type 3. Virginica"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(freq_distr, <span class="at">labels =</span> new_names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Take into account that the order is important in this case: the first new name corresponds to category <code>setosa</code>, the second new name corresponds to species <code>versicolor</code> and the third one to <code>virginica</code>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember that, as the vector <code>new_names</code> contains characters as elements, the quotes ” ” should be used.</p>
</div>
</div>
<p>It is also possible to change the colors of the pie chart. We just need to specify the new vector of colors through the argument <code>col</code>. As we pointed out before, the order is important. This means that the first color corresponds to the category <code>setosa</code> and so on.</p>
<p>It is also possible to add a main title to the graph through the argument <code>main</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>new_colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pie</span>(freq_distr, <span class="at">col =</span> new_colors, <span class="at">main =</span> <span class="st">"Fantastic title"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The labels in the graph are the original names of the vector <code>freq_distr</code>. This is because we did not provide the argument <code>labels</code>!</p>
</div>
</div>
</section>
<section id="bar-chart" class="level5" data-number="1.2.3.2">
<h5 data-number="1.2.3.2" class="anchored" data-anchor-id="bar-chart"><span class="header-section-number">1.2.3.2</span> Bar chart</h5>
<p>In order to visualize categorical variables the bar chart can be used as well.</p>
<p>The function <code>bargraph()</code> from the package <code>mosaic</code> allows us to create a bar chart. The function <code>bargraph()</code> is similar to the function <code>tally()</code> that we have used to create the frequency distribution, as it starts with <code>~</code> followed by the name of the variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bargraph</span>(<span class="sc">~</span> Species, <span class="at">data =</span> iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we would like to have proportions instead of raw frequencies, we need to use the argument <code>type = proportion</code> (not <code>format</code>, as we did for the function <code>tally()</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bargraph</span>(<span class="sc">~</span> Species, <span class="at">data =</span> iris, <span class="at">type =</span> <span class="st">"proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For the function <code>bargraph()</code> many options can be specified. The most important ones are the following.</p>
<ul>
<li>If we want to change the name of the axes, the arguments <code>xlab</code> and <code>ylab</code> are used.</li>
<li>The argument <code>main</code> is used to add a main title to graph.</li>
<li>The two arguments <code>xlim</code> and <code>ylim</code> can be used to change the range of the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>-axis, respectively. It should be a vector of two elements, specifying the desired minimum and maximum for that axis. In the next example the range of the <span class="math inline">\(y\)</span>-axis has been modified, starting at 0 and ending at 0.9.</li>
</ul>
<p>Similar to the pie chart, we can change the color of the bars as well. We just need to provide a vector of colors through the argument <code>col</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bargraph</span>(<span class="sc">~</span> Species, <span class="at">data =</span> iris, <span class="at">type =</span> <span class="st">"proportion"</span>, <span class="at">xlab =</span> <span class="st">"New x lab"</span>, </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">ylab =</span> <span class="st">"New y lab"</span>, <span class="at">main =</span> <span class="st">"New super title"</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.9</span>), </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="**EXERCISE**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>EXERCISE</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Present a pie chart and a bar chart of the variable <code>vs</code> in the dataset <code>mtcars</code>.</p>
<p>Again: remember that, if a categorical variable is not stored as <code>factor</code>, you should convert it!</p>
</div>
</div>
</section>
</section>
</section>
<section id="numerical-variables" class="level3" data-number="1.3">
<h3 data-number="1.3" class="anchored" data-anchor-id="numerical-variables"><span class="header-section-number">1.3</span> Numerical variables</h3>
<p>After having analyzed the categorical variables, we are going to analyze numerical variables (or quantitative variables). Just to recall, a numerical variable is a variable whose values are numbers having a meaning.</p>
<p>As said before, there are four numerical variables in the <code>iris</code> dataset. Let us analyse the numerical variable <code>Sepal.Width</code>.</p>
<section id="numerical-description-of-quantitative-variables" class="level4" data-number="1.3.1">
<h4 data-number="1.3.1" class="anchored" data-anchor-id="numerical-description-of-quantitative-variables"><span class="header-section-number">1.3.1</span> Numerical description of quantitative variables</h4>
<p>In the course we discussed three types of parameters for describing one variable: measures of location, measure of variability and measures of shape.</p>
<p>The measures of location are useful to describe where the observations are located. Among them, the most important are:</p>
<ul>
<li>mean;</li>
<li>median;</li>
<li>mode;</li>
<li>percentiles;</li>
<li>quartiles.</li>
</ul>
<p>However, we are interested also in describing the variability in our data. The most important measures of variability are:</p>
<ul>
<li>range;</li>
<li>interquartile range;</li>
<li>variance;</li>
<li>standard deviation;</li>
</ul>
<p>As a measure of shape we discussed the skewness.</p>
<section id="measures-of-location" class="level5" data-number="1.3.1.1">
<h5 data-number="1.3.1.1" class="anchored" data-anchor-id="measures-of-location"><span class="header-section-number">1.3.1.1</span> Measures of location</h5>
<p>The function <code>summary()</code> can be used to get some descriptive statistics for all the numerical variables in our dataset. In particular, it shows the minimum, the first quartile, the median, the mean, the third quartile and the maximum for all the numerical variables in the dataset. In addition, it shows the frequency distributions of the categorical variables (if they are stored as factors!).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sometimes we don’t need all these values at once, but rather we are just interested in obtaining one of them at a time. When it comes to location parameters, the functions <code>mean()</code> and <code>median()</code> and <code>Mode()</code> are used to obtain, respectively, the mean, the median and the mode of a vector. Just take into account that the latter belongs to the package <code>DescTools</code>, so make sure that you load that package first.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(iris<span class="sc">$</span>Sepal.Width)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(iris<span class="sc">$</span>Sepal.Width)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Mode</span>(iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In a similar way, by using the function <code>quantile()</code>, we can get generic percentiles of a vector. For instance, if we want to find the 10th and the 90th percentile of the variable <code>Sepal.Width</code> we can use</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(iris<span class="sc">$</span>Sepal.Width, <span class="at">probs=</span><span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If we do not specify any percentile through the argument <code>probs</code>, by default, the output is a vector containing the minimum, the first quartile, the median, the second quartile and the maximum of the variable.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The functions <code>max()</code> and <code>min()</code> calculate the maximum and minimum of a vector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(iris<span class="sc">$</span>Sepal.Width)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="**EXERCISE**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>EXERCISE</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find the minimum, the maximum, the mean, the median, the mode, the 15th percentile, the 80th percentile, the first quartile and the third quartile of the variable <code>Petal.Width</code> from the dataset <code>iris</code>.</p>
</div>
</div>
</section>
<section id="measures-of-variability" class="level5" data-number="1.3.1.2">
<h5 data-number="1.3.1.2" class="anchored" data-anchor-id="measures-of-variability"><span class="header-section-number">1.3.1.2</span> Measures of variability</h5>
<p>There is no built-in function in base R that allows for calculating the range of a variable. Fortunately, it is straightforward to calculate the range from its definition:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">max</span>(iris<span class="sc">$</span>Sepal.Width) <span class="sc">-</span> <span class="fu">min</span>(iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>There is a function <code>range()</code> available in base R. Note that it does not calculate the range as we have defined it. Instead, it returns a vector of length two, containing the minimum and the maximum of the variable.</p>
</div>
</div>
<p>Equivalently, there is no built-in function in base R that allows for calculating the Interquartile Range (IQR) of a variable. Once again, making use of the function <code>quantile</code>, it is straightforward to calculate the IQR from its definition:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(iris<span class="sc">$</span>Sepal.Width, <span class="fl">0.75</span>) <span class="sc">-</span> <span class="fu">quantile</span>(iris<span class="sc">$</span>Sepal.Width, <span class="fl">0.25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The functions <code>var()</code> and <code>sd()</code> are used to calculate the variance and the standard deviation (the ones with <span class="math inline">\(N-1\)</span> in the denominator):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(iris<span class="sc">$</span>Sepal.Width)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="**EXERCISE**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>EXERCISE</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find the range, Interquartile range, variance and standard deviation of the variable <code>Petal.Width</code> from the dataset <code>iris</code>.</p>
</div>
</div>
</section>
<section id="skewness" class="level5" data-number="1.3.1.3">
<h5 data-number="1.3.1.3" class="anchored" data-anchor-id="skewness"><span class="header-section-number">1.3.1.3</span> Skewness</h5>
<p>In order to calculate the skewness of a variable, we can make use of the function <code>skewness()</code> from the package <code>e1071</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">skewness</span>(iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="**EXERCISE**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>EXERCISE</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Find the skewness of the variable <code>Petal.Width</code> from the dataset <code>iris</code>.</p>
</div>
</div>
</section>
</section>
<section id="graphical-description-for-numerical-variables" class="level4" data-number="1.3.2">
<h4 data-number="1.3.2" class="anchored" data-anchor-id="graphical-description-for-numerical-variables"><span class="header-section-number">1.3.2</span> Graphical description for numerical variables</h4>
<p>We will describe three graphical tools that are employed here to describe numerical variables: dotplots, histograms and boxplots.</p>
<section id="dotplots" class="level5" data-number="1.3.2.1">
<h5 data-number="1.3.2.1" class="anchored" data-anchor-id="dotplots"><span class="header-section-number">1.3.2.1</span> Dotplots</h5>
<p>We can create dotplots by using the function <code>stripchart()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>However, before we continue, there is something that is not completely satisfactory in the dotplot that we just created. Let us take a look at the actual vales taken by the variable <code>Sepal.Width</code> (sorted in increasing order for convenience)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that some values have multiple occurrences, for instance, the value 2.8 occurs 14 times, the value 3 occurs 26, etc, but this frequency is not evident in the dotplot. The reason for this is that, by default, the multiple occurrences of the same value are plotted over each other, then we only see one point. In order to make the frequency of each point more evident we can use the argument <code>method</code>. The option <code>method = "jitter"</code> will add some noise to the values. The option <code>method = "stack"</code> (Edgar’s note: my favorite one) piles the dots over each other as many times as occurrences the value has. Compare the three dotplots:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(iris<span class="sc">$</span>Sepal.Width)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(iris<span class="sc">$</span>Sepal.Width, <span class="at">method=</span><span class="st">"jitter"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stripchart</span>(iris<span class="sc">$</span>Sepal.Width, <span class="at">method=</span><span class="st">"stack"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="**EXERCISE**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>EXERCISE</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create a dotplot of the variable <code>Petal.Width</code> from the dataset <code>iris</code>. Make sure that the points do not overplot each other.</p>
</div>
</div>
</section>
<section id="histograms" class="level5" data-number="1.3.2.2">
<h5 data-number="1.3.2.2" class="anchored" data-anchor-id="histograms"><span class="header-section-number">1.3.2.2</span> Histograms</h5>
<p>Histograms can be obtained by using the function <code>hist()</code>, which is part of base R, or by using the function <code>histogram()</code> from the package <code>mosaic</code>. In general terms, there is no difference between the usage of the two functions, as they have almost the same options. However, the function <code>histogram()</code>, as we will see later, is more flexible.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(<span class="sc">~</span> Sepal.Width, <span class="at">data =</span> iris)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The argument <code>breaks</code> can be used to specify the width of the bars. We can either input a vector giving the break points for the bins:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(<span class="sc">~</span> Sepal.Width, <span class="at">data =</span> iris, <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">2.0</span>, <span class="fl">2.5</span>, <span class="fl">3.0</span>, <span class="fl">4.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>or as a number indicating the number of bars that we would like to have:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(<span class="sc">~</span> Sepal.Width, <span class="at">data =</span> iris, <span class="at">breaks =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled" title="The argument `breaks`">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The argument <code>breaks</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Remember that defining bins of varying widths is not recommended, therefore, it is not recommended to use the argument <code>breaks</code> for defining the break points of the bins. However, if you still decide to use it this way (or you have to), note that R automatically corrects the height of the bars in order to follow the “area principle”.</p>
<p>On the other hand, take into account that if you use the argument <code>breaks</code> for defining the number of bins, this is just a “suggestion” for R! This means that, if you provide the number of breaks, then, most likely, you will not have exactly that number of bars. For instance, in our previous example, we got 24 bins.</p>
</div>
</div>
<p>As before, it is possible to use the arguments <code>xlab</code> and <code>ylab</code> to change the labels of the axes, <code>main</code> to provide a main title and <code>col</code> to change the color of the bars.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="**EXERCISE**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>EXERCISE</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create a histogram of the variable <code>Petal.Width</code> from the dataset <code>iris</code> with (more or less) 12 bins.</p>
</div>
</div>
</section>
<section id="boxplots" class="level5" data-number="1.3.2.3">
<h5 data-number="1.3.2.3" class="anchored" data-anchor-id="boxplots"><span class="header-section-number">1.3.2.3</span> Boxplots</h5>
<p>We can create boxplots by using the function <code>boxplot()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Width)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The lower limit of the box represents the first quartile <span class="math inline">\(\breve{x}_{0.25}\)</span>. The upper limit of the box represents the third quartile <span class="math inline">\(\breve{x}_{0.75}\)</span>. The wide black line in the middle represents the median. The lower whisker extends either to the minimum or to <span class="math inline">\(\breve{x}_{0.25} - 1.5 \cdot IQR\)</span>. The upper whisker extends either to the maximum or to <span class="math inline">\(\breve{x}_{0.75} + 1.5 \cdot IQR\)</span>. Any value beyond the whiskers is shown as a single point and it is considered as a “potential outlier”</p>
<p>As always, it is possible to use the arguments <code>xlab</code> and <code>ylab</code> to change the labels of the axes, <code>main</code> to provide a main title and <code>col</code> to change the color of the box. For instance, if we want to have a box with a light green color and we want to add the main title “Petal width” to our plot, we can use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(iris<span class="sc">$</span>Sepal.Width, <span class="at">main=</span><span class="st">"Petal width"</span>, <span class="at">col=</span><span class="st">"lightgreen"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="**EXERCISE**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>EXERCISE</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create a boxplot of the variable <code>Petal.Width</code> from the dataset <code>iris</code>. Add an appropriate title and use a light blue color for the box.</p>
</div>
</div>
</section>
</section>
</section>
<section id="missing-values" class="level3" data-number="1.4">
<h3 data-number="1.4" class="anchored" data-anchor-id="missing-values"><span class="header-section-number">1.4</span> Missing values</h3>
<p>For this subsection we are going to make use of the dataset <code>Titanic</code> that we downloaded from Athena at the beginning of the session. The dataset contains real data on the Titanic wreck. We can read the dataset into R by using the function <code>xlsx()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">"Titanic.xlsx"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(titanic)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(titanic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>It may happen that in our dataset we have some missing values. This means that for some elements data is missing for one or more variables. In R missing data are stored as <code>NA</code> (Not Available) or <code>NaN</code> (Not a Number, a result of undefined calculations such us <span class="math inline">\(0/0\)</span>).</p>
<p>The function <code>summary()</code> also shows the number of missing values that a particular variable has (of course, if there are missing values!).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(titanic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can see, for instance, that the variable <code>Age</code> has 3 missing values.</p>
<p>Some functions can handle missing data. In fact, even if we provide a vector with missing data, they are able to produce a result by ignoring the observations that have missing values. On the other hand, other functions are not able to handle missing data. This means that we don’t get any result if we provide a vector with missing values. For example, when we have missing values, the mean or the other descriptive statistics cannot be computed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(titanic<span class="sc">$</span>Age)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(titanic<span class="sc">$</span>Age)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Luckily, we can provide the argument <code>na.rm = TRUE</code>, that tells R to ignore the missing values while calculating the descriptive statistic.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(titanic<span class="sc">$</span>Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">median</span>(titanic<span class="sc">$</span>Age, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In addition, the function <code>na.omit()</code> removes all the observations from a vector that have <code>NA</code> or <code>NaN</code>, that is, missing values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>age_new <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(titanic<span class="sc">$</span>Age)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(titanic<span class="sc">$</span>Age)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(age_new)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In general, we should be very cautious when dealing with missing data. In fact, we should think a lot before removing them from the analysis, especially if we consider more variables simultaneously.</p>
</section>
</section>
<section id="second-part" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="second-part"><span class="header-section-number">2</span> Second Part</h2>
<p>The second part of this computer lab is focused on describing the relationship between two categorical variables, and between one numerical variable and one (or more) categorical variable(s).</p>
<section id="relationship-between-two-categorical-variables" class="level3" data-number="2.1">
<h3 data-number="2.1" class="anchored" data-anchor-id="relationship-between-two-categorical-variables"><span class="header-section-number">2.1</span> Relationship between two categorical variables</h3>
<p>For this part of the lab, we use the dataset <code>SmartPhones.RData</code>, which we downloaded at the beginning of the session. It is a dataset that contains information about the age (in age bins, variable <code>age.group</code>) and the brand of the smartphone they use (variable <code>brand</code>) for 2498 people.</p>
<p>Since it is an <code>RData</code> file, it can be loaded into R by using the function <code>load(")</code>, as explained in Computer Lab 1:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"SmartPhones.RData"</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(SmartPhones)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(SmartPhones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Before starting, it is important to notice that, the two categorical variable <code>age.group</code> and <code>brand</code> are not stored as <code>factor</code>. Thus, let us convert them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>SmartPhones<span class="sc">$</span>age.group <span class="ot">&lt;-</span> <span class="fu">factor</span>(SmartPhones<span class="sc">$</span>age.group)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(SmartPhones<span class="sc">$</span>age.group)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>SmartPhones<span class="sc">$</span>brand <span class="ot">&lt;-</span> <span class="fu">factor</span>(SmartPhones<span class="sc">$</span>brand)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(SmartPhones<span class="sc">$</span>brand)</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(SmartPhones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us start by creating a contingency table. A contingency table summarizes the information contained in two categorical variables. It contains the frequencies of all the possible combinations between pairs of categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">levels</span>(SmartPhones<span class="sc">$</span>age.group))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(<span class="fu">levels</span>(SmartPhones<span class="sc">$</span>brand))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Since <code>age.group</code> has 3 categories and <code>brand</code> has 9 categories, we will have a table with <span class="math inline">\(3 \cdot 9 = 27\)</span> entries.</p>
<p>In order to create a contingency table, we can use the function <code>tally()</code> which we have used to create frequency distribution, as follows:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(<span class="sc">~</span> brand <span class="sc">+</span> age.group, <span class="at">data =</span> SmartPhones)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the variable that is specified first will be placed on the rows.</p>
<p>We can easily add the row and column totals to the contingency table by specifying the argument <code>margins = TRUE</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(<span class="sc">~</span> brand <span class="sc">+</span> age.group, <span class="at">data =</span> SmartPhones, <span class="at">margins =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The interpretation of the contingency table is quite straightforward. For example, we can see that out of 2498 people, 25 of them belong to the age group 18-34 and they have an Asus as smartphone.</p>
<div class="callout callout-style-default callout-tip callout-titled" title="**EXERCISE**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>EXERCISE</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Switch the order of the variables while creating the contingency table. Do the frequencies change? Should they change?</p>
<p>Answer the following questions:</p>
<ul>
<li>How many people have an iPhone?</li>
<li>How many people belong to the age group 35-49?</li>
<li>How many people in the age group 18-34 have a smartphone Sony?</li>
</ul>
</div>
</div>
<p>It is possible to get the joint relative distribution. The joint relative distribution is obtained by dividing each entry of the table by the total number of observations (2498). To obtain it, the argument <code>format = proportion</code> should be specified.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(<span class="sc">~</span> brand <span class="sc">+</span> age.group, <span class="at">data =</span> SmartPhones, <span class="at">margins =</span> <span class="cn">TRUE</span>, <span class="at">format =</span> <span class="st">"proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>By dividing each entry of the relative distribution table by the column totals, we obtain the distribution of the brand <em>conditioned</em> on the age group. On the other hand, if we divide each entry of the relative distribution table by the row totals, we get the distribution of the age group <em>conditioned</em> on the brand.</p>
<p>It is important to say that, if we are conditioning on the variable on the columns, then the comparison should be made among the rows and viceversa.</p>
<p>Now, for illustration purposes, we are going to obtain the distribution of the brand conditioned on the age group. As before, the function <code>tally()</code> is used, but the syntax is a bit different: the symbol <code>|</code> is used to denote “conditioned on”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tally</span>(<span class="sc">~</span> brand <span class="sc">|</span> age.group, <span class="at">data =</span> SmartPhones, <span class="at">margins =</span> <span class="cn">TRUE</span>, <span class="at">format =</span> <span class="st">"proportion"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The interpretation is a bit different with respect to the contingency table. First of all, as we are conditioning on the age group, that is the variable in the columns, the comparison should be made among the rows. For example, we can see that about 41% of the people between 18-34 have an iPhone. Regarding the age group 50+, 29% of the people in this age group have an iPhone. We can observe that there is a difference of <span class="math inline">\(41 - 29 = 12\)</span> percentage units. This can suggest a possible relationship between the two variables.</p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>There is also another way to write the condition <code>~ brand | age.group</code>, where we are saying that the variable <code>brand</code> should be conditioned on <code>age.group</code>, without using the symbol <code>|</code>. Alternatively, we can write <code>brand ~ age.group</code>. The meaning is basically the same but the syntax is different.</p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="**EXERCISE**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>EXERCISE</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<p>What do you think about the brand LG? Is the proportion of LG users different among the three age groups?</p>
<p>Obtain the conditional distribution of the brand conditioned on the age group. Try to interpret some entries of the table.</p>
</div>
</div>
</section>
<section id="relationship-between-one-numerical-variable-and-one-or-more-categorical-variables." class="level3" data-number="2.2">
<h3 data-number="2.2" class="anchored" data-anchor-id="relationship-between-one-numerical-variable-and-one-or-more-categorical-variables."><span class="header-section-number">2.2</span> Relationship between one numerical variable and one (or more) categorical variable(s).</h3>
<p>Earlier in this lab, we have presented histograms and boxplots and how they can be used to describe graphically a numerical variable. The idea is to create a histogram or a boxplot of the numerical variable for each category of the categorical variable. The resulting histograms or boxplots are actually a conditional distribution, as we just make use of the observations that belong to that specific category of the categorical variable that we are conditioning on.</p>
<p>In order to illustrate this concept, we are going to use the dataset <code>FevChildren.RData</code>. The dataset contains data about the forced expiratory volume (variable <code>fev</code>), the height (in cm, variable <code>height</code>), the age (in years, variable <code>age</code>), smoking status (variable <code>smoking</code>, 1=“Yes”, 0=“No”), sex (variable <code>gender</code>) and age group (variable <code>age.group</code>) measured on 606 children and adolescents. Note that the categorical variables are already stored as <code>factor</code> variables!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"FevChildren.RData"</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(FevChildren)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(FevChildren)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We want to plot a histogram of the variable <code>fev</code> for the different categories of the variable <code>age-group</code>, so we should get three histograms. The three histograms can be obtained by using the function <code>histogram()</code> from the package <code>mosaic</code> that we have presented before. Since we are conditioning on the variable <code>age.group</code>, the syntax of the function should include the symbol <code>|</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(<span class="sc">~</span> fev <span class="sc">|</span> age.group, <span class="at">data =</span> FevChildren)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can also get some descriptive statistics, like the mean and the median, of the variable <code>fev</code> conditioning on <code>age.group</code>. For this purpose, the function <code>favstats()</code> from the package <code>mosaic</code> can be used. Its syntax is similar to that of <code>histogram()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">favstats</span>(<span class="sc">~</span> fev <span class="sc">|</span> age.group, <span class="at">data =</span> FevChildren)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can see from the histograms and the descriptive statistics that larger values of the forced expiratory volume are found in the older age group.</p>
<p>It is possible to condition on more than one categorical variable. For example, we can condition on the categorical variables <code>age.group</code> and <code>gender</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(<span class="sc">~</span> fev <span class="sc">|</span> age.group <span class="sc">+</span> gender, <span class="at">data =</span> FevChildren)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">favstats</span>(<span class="sc">~</span> fev <span class="sc">|</span> age.group <span class="sc">+</span> gender, <span class="at">data =</span> FevChildren)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can use boxplots as well, however, the syntax is actually a bit different compared to the function <code>histogram()</code>. Instead of using the syntax <code>~ fev | age.group + gender</code>, where we are saying that the variable <code>fev</code> should be conditioned on <code>age.group</code> and <code>gender</code>, the syntax <code>fev ~ age.group + gender</code> should be used.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(fev <span class="sc">~</span> age.group <span class="sc">+</span> gender, <span class="at">data =</span> FevChildren)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="**EXERCISE**">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<strong>EXERCISE</strong>
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Study the relationship between <code>fev</code> and <code>smoking</code> by using both histograms and boxplots. Use also the function <code>favstats()</code> and comment on the results.</li>
<li>Study the relationship between <code>fev</code> and the two categorical variables <code>smoking</code> and <code>gender</code> by using both histograms and boxplots. Use also the function <code>favstats()</code> and comment on the results.</li>
</ul>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>